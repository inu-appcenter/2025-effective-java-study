# 아이템 15

### 정보 은닉의 장점

- **개발 속도 향상**: 컴포넌트를 병렬로 개발 가능
- **관리 비용 절감**: 각 컴포넌트를 독립적으로 디버깅/교체 가능
- **성능 최적화 용이성**: 특정 컴포넌트만 최적화 가능
- **재사용성 향상**: 독립적으로 동작하는 컴포넌트
- **대규모 시스템 개발 난이도 완화**: 개별 컴포넌트 검증 가능

### Java 접근 제어자별 범위

1. **private**: 선언한 클래스에서만 접근
2. **package-private(default)**: 같은 패키지 내에서 접근 (기본값)
3. **protected**: 같은 패키지 + 하위 클래스에서 접근
4. **public**: 모든 곳에서 접근

**권장사항**:

- 제일 상위 클래스/인터페이스는 package-private(default) 우선
- 멤버는 private으로 시작해서 필요시에만 확장
- public 클래스의 인스턴스 필드는 public 금지
- 배열 필드의 public 노출 금지

```java
public class Account {

    public String accountNumber;
    public int balance;
    public String[] history;

    public Account(String accountNumber, int balance) {
        this.accountNumber = accountNumber;
        this.balance = balance;
        this.history = new String[10];
    }

    public void deposit(int amount) {
        this.balance += amount;
    }

    @Override
    public String toString() {
        return "Account{" +
                "accountNumber='" + accountNumber + '\'' +
                ", balance=" + balance +
                ", history=" + Arrays.toString(history) +
                '}';
    }
}

public static void main(String[] args) {
    Account account = new Account("1111", 100000);
    account.balance = -10000;
    account.accountNumber = "2222";
    account.history[0] = "dfafdafasdf";

    System.out.println(account);
}

// Account{accountNumber='2222', balance=-10000, history=[dfafdafasdf, null, null, null, null, null, null, null, null, null]}

public static void main(String[] args) {
    Account account = new Account("1111", 100000);
    account.balance = -10000;
    account.accountNumber = "2222";
    account.history[0] = "dfafdafasdf";

    Account account1 = new Account("2222", 100000);
    account1.history = account.history;

    account.history[1] = "dfafdafasdf";

    System.out.println("account : "+ account);
    System.out.println("account1 : "+ account1);

}

// account : Account{accountNumber='2222', balance=-10000, history=[dfafdafasdf, dfafdafasdf, null, null, null, null, null, null, null, null]}
// account1 : Account{accountNumber='2222', balance=100000, history=[dfafdafasdf, dfafdafasdf, null, null, null, null, null, null, null, null]}

public class GoodAccount {

    private final String accountNumber;
    public int balance;
    private List<String> history;

    private static final int MIN_BALANCE = 0;
    private static final int MAX_DAILY_WITHDRAW = 10000;

    public GoodAccount(String accountNumber, int balance) {
        AccountUtils.isValidAccountNumber(accountNumber);

        if (balance < MIN_BALANCE) {
            throw new IllegalArgumentException("balance must be greater than or equal to MIN_BALANCE");
        }

        this.accountNumber = accountNumber;
        this.balance = balance;
        this.history = new ArrayList<>();
    }

    public String getAccountNumber() {
        return accountNumber;
    }

    public int getBalance() {
        return balance;
    }

    public List<String> getHistory() {
        return history;
    }

    public void deposit(int amount) {
        if (amount <= MIN_BALANCE) {
            throw new IllegalArgumentException("balance must be greater than or equal to MIN_BALANCE");
        }

        this.balance += amount;
        history.add(this.accountNumber + " deposited " + amount);
    }

    public boolean withdraw(int amount) {
        if (amount <= MIN_BALANCE) {
            throw  new IllegalArgumentException("balance must be greater than or equal to MIN_BALANCE");
        }

        if (amount > MAX_DAILY_WITHDRAW) {
            throw new IllegalArgumentException("amount must be less than MAX_DAILY_WITHDRAW");
        }

        if (balance - amount < MIN_BALANCE) {
            return false;
        }

        balance -= amount;
        history.add(this.accountNumber + " withdrawn " + amount);
        return true;
    }

    public void setHistory(List<String> history) {
        this.history = new ArrayList<>(history);
    }

    @Override
    public String toString() {
        return "GoodAccount{" +
                "accountNumber='" + accountNumber + '\'' +
                ", balance=" + balance +
                ", history=" + history +
                '}';
    }
}

public static void main(String[] args) {
    GoodAccount account1 = new GoodAccount("123-456", 5000);
    account1.withdraw(5000);

    GoodAccount account2 = new GoodAccount("456-789", 6000);
    account2.setHistory(account1.getHistory());

    account1.deposit(2000);

    System.out.println("account1 : " + account1);
    System.out.println("account2 : " +  account2);
}

// account1 : GoodAccount{accountNumber='123-456', balance=2000, history=[123-456 withdrawn 5000, 123-456 deposited 2000]}
// account2 : GoodAccount{accountNumber='456-789', balance=6000, history=[123-456 withdrawn 5000]}
```