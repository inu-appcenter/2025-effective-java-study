# Item 5

추가 일시: 2025년 9월 5일 오후 5:26
강의: Effective JAVA

## 🍀 Item 5: 자원을 직접 명시하지 말고 의존 객체 주입을 사용하라

---

많은 클래스는 하나 이상의 자원에 의존한다. 사용하는 자원에 따라 동작이 달라지는 클래스에는 정적 유틸리티 클래스나 싱글톤 방식을 사용했을 때, 다양한 문제가 있다.

- 유연성 부족: 정적 유틸리티 클래스와 싱글톤은 하나의 자원에만 고정되어있다.
- 테스트 어려움: 단위 테스트를 할 때 mock객체 주입에 어려움이 있다.
- 단일 책임 원칙 위반: 클래스가 자신의 기능 외에도 자원 관리 책임까지 져야한다.

또한 책에서 언급한대로, final 을 제거하고 자원을 교체하는 메서드를 추가하면 여러 스레드가 동시에 자원을 바꾸려 할 때 동시성 문제가 발생한다.

우리는 클래스가 여러 자원 인스턴스를 지원하며, 클라이언트가 원하는 자원을 사용하는 좋은 방법이 있다.

인스턴스를 생성할 때 생성자에 필요한 자원을 넘겨주는 방식이다.

### 의존 객체 주입

```java
class OrderService {
	private final PaymentProcessor paymentProcessor;
	
	public OrderService(PaymentProcessor paymentProcessor){
		this.paymentProcessor = Objects.requireNonNull(paymentProcessor);
	}
}
```

이는 자원이 몇 개든 의존 관계가 어떻든 문제가 되지 않는다.

또한 불변을 보장하여 같은 자원을 사용하는 여러 클라이언트가 의존 객체들을 안심하고 공유할 수 있다.

해당 패턴의 변형으로 생성자에 자원 팩터리를 넘겨주는 방식이 있다.

의존 객체 주입은 유연성과 테스트 용이성을 개선한다. 다만, 코드 가독성이 떨어지기도 한다.

이는 Spring과 같은 의존 객체 주입 프레임워크를 사용하여 해결 할 수 있다.